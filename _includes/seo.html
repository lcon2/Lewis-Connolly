{%- assign page_title = page.title | default: site.title -%}
{%- assign site_title = site.title | default: '' -%}
{%- if page_title and site_title and page_title != site_title -%}
  <title>{{ page_title }} | {{ site_title }}</title>
{%- else -%}
  <title>{{ site_title | default: page_title }}</title>
{%- endif -%}
{%- assign description = page.description | default: page.excerpt | default: site.description -%}
{%- if description -%}
  <meta name="description" content="{{ description | strip_html | strip_newlines | escape }}">
{%- endif -%}
<link rel="canonical" href="{{ page.url | absolute_url }}">
<meta property="og:site_name" content="{{ site.title | escape }}">
<meta property="og:title" content="{{ page_title | escape }}">
{%- if description -%}
<meta property="og:description" content="{{ description | strip_html | strip_newlines | escape }}">
{%- endif -%}
<meta property="og:url" content="{{ page.url | absolute_url }}">
{%- assign og_image = page.og_image | default: site.og_image | default: '/assets/images/logo.png' -%}
<meta property="og:image" content="{{ og_image | absolute_url }}">
<meta property="og:image:alt" content="{{ page_title | escape }}">
<meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
{%- if page.layout == 'post' and page.date -%}
<meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
{%- endif -%}
<meta name="twitter:card" content="summary_large_image">
{%- if site.twitter_username and site.twitter_username != "" -%}
<meta name="twitter:site" content="@{{ site.twitter_username }}">
{%- endif -%}
<meta name="twitter:title" content="{{ page_title | escape }}">
{%- if description -%}
<meta name="twitter:description" content="{{ description | strip_html | strip_newlines | escape }}">
{%- endif -%}
<meta name="twitter:image" content="{{ og_image | absolute_url }}">

{%- if page.layout == 'post' -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": {{ page_title | jsonify }},
  "description": {{ description | strip_html | strip_newlines | jsonify }},
  "image": {{ og_image | absolute_url | jsonify }},
  "datePublished": {{ page.date | date_to_xmlschema | jsonify }},
  "dateModified": {{ page.last_modified_at | default: page.date | date_to_xmlschema | jsonify }},
  "author": {
    "@type": "Person",
    "name": {{ page.author | default: "Lewis Connolly" | jsonify }}
  },
  "publisher": {
    "@type": "Organization",
    "name": {{ site.title | jsonify }},
    "logo": {
      "@type": "ImageObject",
      "url": {{ "/assets/images/logo.png" | absolute_url | jsonify }}
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ page.url | absolute_url | jsonify }}
  }
}
</script>
{%- elsif page.url == "/" or page.layout == 'home' -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": {{ site.title | jsonify }},
  "url": {{ site.url | append: site.baseurl | jsonify }},
  "description": {{ site.description | strip_html | strip_newlines | jsonify }}
}
</script>
{%- endif -%}
